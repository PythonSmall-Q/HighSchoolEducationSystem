# é«˜ä¸­æ•™è‚²ç®¡ç†ç³»ç»Ÿ

åŸºäº Cloudflare Workers å’Œ D1 æ•°æ®åº“çš„ç°ä»£åŒ–é«˜ä¸­æ•™è‚²ç®¡ç†ç³»ç»Ÿï¼Œæä¾›å­¦ç”Ÿã€æ•™å¸ˆå’Œç®¡ç†å‘˜ä¸‰ä¸ªè§’è‰²çš„å®Œæ•´åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“ å­¦ç”Ÿç«¯
- **è¯¾è¡¨æŸ¥çœ‹**ï¼šæŸ¥çœ‹å½“å‰å­¦æœŸçš„è¯¾ç¨‹å®‰æ’ï¼ŒåŒ…æ‹¬æ—¶é—´ã€æ•™å®¤å’Œæˆè¯¾æ•™å¸ˆ
- **æˆç»©æŸ¥è¯¢**ï¼šæŸ¥çœ‹å¹³æ—¶æˆç»©ã€æœŸä¸­æˆç»©ã€æœŸæœ«æˆç»©å’Œæ€»è¯„
- **å¹´çº§æ’å**ï¼šæŸ¥çœ‹è‡ªå·±åœ¨å¹´çº§ä¸­çš„æ’åå’Œç™¾åˆ†ä½
- **æˆç»©è¶‹åŠ¿**ï¼šé€šè¿‡æŠ˜çº¿å›¾æŸ¥çœ‹å†å²æˆç»©å˜åŒ–è¶‹åŠ¿
- **æœŸæœ«è¯„æ•™**ï¼šå¯¹ä»»è¯¾æ•™å¸ˆè¿›è¡ŒåŒ¿åè¯„æ•™

### ğŸ‘¨â€ğŸ« æ•™å¸ˆç«¯
- **è¯¾è¡¨ç®¡ç†**ï¼šæŸ¥çœ‹è‡ªå·±çš„æˆè¯¾å®‰æ’
- **ç­çº§åå•**ï¼šä¸‹è½½æ‰€æ•™ç­çº§çš„å­¦ç”Ÿåå•
- **æˆç»©å½•å…¥**ï¼šä¸Šä¼ å’Œæ›´æ–°å­¦ç”Ÿçš„å¹³æ—¶ã€æœŸä¸­ã€æœŸæœ«æˆç»©
- **è¯„æ•™ç»“æœ**ï¼šæŸ¥çœ‹å­¦ç”Ÿè¯„æ•™çš„ç»¼åˆç»“æœï¼ˆåŒ¿åï¼‰
- **è°ƒè¯¾ç”³è¯·**ï¼šæäº¤ä¸´æ—¶æˆ–é•¿æœŸè°ƒè¯¾ç”³è¯·
- **ä»£è¯¾ç”³è¯·**ï¼šç”³è¯·ä»£è¯¾å¹¶é€šçŸ¥ç³»ç»Ÿ

### ğŸ›¡ï¸ ç®¡ç†å‘˜ç«¯
- **è¯„æ•™ç®¡ç†**ï¼šè®¾ç½®è¯„æ•™é¢˜ç›®ã€å¼€å¯è¯„æ•™æœŸ
- **ç”³è¯·å®¡æ ¸**ï¼šå®¡æ ¸æ•™å¸ˆçš„è°ƒè¯¾å’Œä»£è¯¾ç”³è¯·
- **æˆç»©ç»Ÿè®¡**ï¼šæŸ¥çœ‹å…¨æ ¡æˆç»©åˆ†å¸ƒã€å„ç§‘å¹³å‡åˆ†
- **ç”¨æˆ·ç®¡ç†**ï¼šåˆ›å»ºå’Œç®¡ç†å­¦ç”Ÿã€æ•™å¸ˆè´¦å·

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

- **å‰ç«¯**ï¼šHTML + CSS + JavaScriptï¼ˆåµŒå…¥å¼å•é¡µåº”ç”¨ï¼‰
- **åç«¯**ï¼šCloudflare Workersï¼ˆTypeScriptï¼‰
- **æ•°æ®åº“**ï¼šCloudflare D1ï¼ˆSQLiteï¼‰
- **è®¤è¯**ï¼šJWT Token
- **CDN**ï¼šCloudflare å…¨çƒ CDN åŠ é€Ÿ

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18+
- npm æˆ– yarn
- Cloudflare è´¦å·

### 1. å®‰è£…ä¾èµ–

\`\`\`bash
npm install
\`\`\`

### 2. åˆ›å»º D1 æ•°æ®åº“

\`\`\`bash
# åˆ›å»ºæ•°æ®åº“
npx wrangler d1 create education-db

# å°†è¿”å›çš„ database_id å¡«å…¥ wrangler.toml æ–‡ä»¶
\`\`\`

### 3. åˆå§‹åŒ–æ•°æ®åº“

\`\`\`bash
# æœ¬åœ°å¼€å‘ç¯å¢ƒ
npm run db:init

# ç”Ÿäº§ç¯å¢ƒ
npm run db:migrate
\`\`\`

### 4. é…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ \`wrangler.toml\` æ–‡ä»¶ï¼Œä¿®æ”¹ \`JWT_SECRET\` ä¸ºå®‰å…¨çš„éšæœºå­—ç¬¦ä¸²ï¼š

\`\`\`toml
[vars]
JWT_SECRET = "your-very-secure-random-secret-key-here"
\`\`\`

### 5. æœ¬åœ°å¼€å‘

\`\`\`bash
npm run dev
\`\`\`

è®¿é—® \`http://localhost:8787\` æŸ¥çœ‹åº”ç”¨ã€‚

### 6. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

\`\`\`bash
npm run deploy
\`\`\`

## ğŸ” é»˜è®¤è´¦å·

é¦–æ¬¡éƒ¨ç½²åï¼Œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼š

- **ç”¨æˆ·å**ï¼šadmin
- **å¯†ç **ï¼šadmin123

âš ï¸ **å®‰å…¨æé†’**ï¼šé¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼

## ğŸ“Š æ•°æ®åº“ç»“æ„

ç³»ç»ŸåŒ…å«ä»¥ä¸‹æ ¸å¿ƒè¡¨ï¼š

- \`users\` - ç”¨æˆ·åŸºç¡€ä¿¡æ¯
- \`students\` - å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯
- \`teachers\` - æ•™å¸ˆè¯¦ç»†ä¿¡æ¯
- \`classes\` - ç­çº§ä¿¡æ¯
- \`courses\` - è¯¾ç¨‹ä¿¡æ¯
- \`schedules\` - è¯¾è¡¨å®‰æ’
- \`grades\` - æˆç»©è®°å½•
- \`evaluations\` - è¯„æ•™ç»“æœ
- \`reschedule_requests\` - è°ƒè¯¾ç”³è¯·
- \`substitute_requests\` - ä»£è¯¾ç”³è¯·

è¯¦è§ [schema.sql](schema.sql)

## ğŸ”Œ API ç«¯ç‚¹

### å…¬å¼€ç«¯ç‚¹
- \`POST /api/login\` - ç”¨æˆ·ç™»å½•

### å­¦ç”Ÿç«¯ç‚¹
- \`GET /api/student/schedule\` - è·å–è¯¾è¡¨
- \`GET /api/student/grades\` - è·å–æˆç»©
- \`GET /api/student/ranking\` - è·å–æ’å
- \`GET /api/student/grade-trend\` - æˆç»©è¶‹åŠ¿
- \`POST /api/student/evaluation/submit\` - æäº¤è¯„æ•™

### æ•™å¸ˆç«¯ç‚¹
- \`GET /api/teacher/schedule\` - è·å–è¯¾è¡¨
- \`GET /api/teacher/class-students\` - è·å–ç­çº§åå•
- \`POST /api/teacher/upload-grades\` - ä¸Šä¼ æˆç»©
- \`POST /api/teacher/reschedule-request\` - æäº¤è°ƒè¯¾ç”³è¯·
- \`POST /api/teacher/substitute-request\` - æäº¤ä»£è¯¾ç”³è¯·

### ç®¡ç†å‘˜ç«¯ç‚¹
- \`GET /api/admin/pending-requests\` - è·å–å¾…å®¡æ ¸ç”³è¯·
- \`POST /api/admin/review-reschedule\` - å®¡æ ¸è°ƒè¯¾ç”³è¯·
- \`POST /api/admin/review-substitute\` - å®¡æ ¸ä»£è¯¾ç”³è¯·
- \`GET /api/admin/grade-statistics\` - è·å–æˆç»©ç»Ÿè®¡
- \`POST /api/admin/create-user\` - åˆ›å»ºç”¨æˆ·

## ğŸš€ éƒ¨ç½²è¯´æ˜

### å¼€å‘ç¯å¢ƒ

\`\`\`bash
# å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
npm run dev

# ä½¿ç”¨æœ¬åœ° D1 æ•°æ®åº“
npm run db:init
\`\`\`

### ç”Ÿäº§ç¯å¢ƒ

\`\`\`bash
# 1. åˆ›å»ºç”Ÿäº§æ•°æ®åº“
npx wrangler d1 create education-db

# 2. æ›´æ–° wrangler.toml ä¸­çš„ database_id

# 3. åˆå§‹åŒ–ç”Ÿäº§æ•°æ®åº“
npm run db:migrate

# 4. éƒ¨ç½²åˆ° Cloudflare Workers
npm run deploy
\`\`\`

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ \`src/api/\` ä¸‹åˆ›å»ºæˆ–ä¿®æ”¹ç›¸åº”çš„ API å‡½æ•°
2. åœ¨ \`src/index.ts\` ä¸­æ·»åŠ è·¯ç”±
3. æ›´æ–°å‰ç«¯é¡µé¢è°ƒç”¨æ–°çš„ API

### æ•°æ®åº“è¿ç§»

ä¿®æ”¹ \`schema.sql\` åæ‰§è¡Œï¼š

\`\`\`bash
# æœ¬åœ°
npm run db:init

# ç”Ÿäº§
npm run db:migrate
\`\`\`

### è°ƒè¯•æŠ€å·§

- ä½¿ç”¨ \`wrangler tail\` æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒæ—¥å¿—
- æœ¬åœ°å¼€å‘æ—¶æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
- ä½¿ç”¨ Cloudflare Dashboard æŸ¥çœ‹ D1 æ•°æ®

## ğŸ› ï¸ æŠ€æœ¯æ ˆè¯´æ˜

### ä¸ºä»€ä¹ˆé€‰æ‹© Cloudflare Workers?

1. **å…¨çƒ CDN**ï¼šè‡ªåŠ¨åœ¨å…¨çƒ 200+ èŠ‚ç‚¹éƒ¨ç½²ï¼Œå»¶è¿Ÿä½è‡³ 10ms
2. **æ— æœåŠ¡å™¨**ï¼šæ— éœ€ç®¡ç†æœåŠ¡å™¨ï¼Œè‡ªåŠ¨æ‰©å±•
3. **æˆæœ¬ä½å»‰**ï¼šå…è´¹å¥—é¤æ¯å¤© 100,000 è¯·æ±‚
4. **å¼€å‘ç®€å•**ï¼šTypeScript æ”¯æŒï¼Œç°ä»£åŒ–å¼€å‘ä½“éªŒ

### ä¸ºä»€ä¹ˆé€‰æ‹© D1?

1. **è¾¹ç¼˜æ•°æ®åº“**ï¼šä¸ Workers æ·±åº¦é›†æˆï¼Œä½å»¶è¿Ÿ
2. **SQLite å…¼å®¹**ï¼šç†Ÿæ‚‰çš„ SQL è¯­æ³•
3. **è‡ªåŠ¨å¤‡ä»½**ï¼šCloudflare è‡ªåŠ¨ç®¡ç†å¤‡ä»½å’Œæ¢å¤
4. **å…è´¹é¢åº¦**ï¼šé€‚åˆä¸­å°å‹åº”ç”¨

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **ï¼šé¦–æ¬¡éƒ¨ç½²åç«‹å³ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
2. **ä½¿ç”¨å¼ºå¯†ç **ï¼š\`JWT_SECRET\` ä½¿ç”¨ 32 å­—ç¬¦ä»¥ä¸Šçš„éšæœºå­—ç¬¦ä¸²
3. **HTTPS**ï¼šCloudflare è‡ªåŠ¨æä¾› SSL/TLS åŠ å¯†
4. **è¾“å…¥éªŒè¯**ï¼šæ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½éœ€è¦è¿›è¡ŒéªŒè¯
5. **SQL æ³¨å…¥é˜²æŠ¤**ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆå·²å®ç°ï¼‰

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ GitHub Issues è”ç³»ã€‚

---

**æ³¨æ„**ï¼šæ­¤é¡¹ç›®ä¸ºæ•™è‚²ç®¡ç†ç³»ç»Ÿç¤ºä¾‹ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰è¯·æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œå®‰å…¨åŠ å›ºå’ŒåŠŸèƒ½å®Œå–„ã€‚
